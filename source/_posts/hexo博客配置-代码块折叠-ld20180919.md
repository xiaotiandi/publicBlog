---
title: hexo博客配置-代码块折叠
author: ledong
comments: true
tags:
  - Hexo
  - 代码风格
  - 技术构架
  - 个人博客
categories:
  - 技术构架
  - 个人博客
keywords: 'Hexo,代码块折叠, 搭建个人博客'
description: 本文主要介绍如何在Hexo中折叠代码块。
abbrlink: 1985df3b
date: 2018-09-19 12:00:00
---

> 本文所用的架构或思路参考该文：{% post_link hexo博客配置-主题管理与配置 %}

## 添加代码块折叠功能

先建立`hexo-theme-next/scripts/custom/fold_tag.js`，

{% include_code lang:js ../themes/hexo-theme-next/scripts/custom/fold_tag.js %}

还有`hexo-theme-next/source/custom/fold_action.js`文件，

{% include_code lang:js ../themes/hexo-theme-next/source/custom/fold_action.js %}

然后创建文件`hexo-theme-next/layout/_custom/post-details.swig`如下

```html
{# hexo-theme-next/layout/_custom/post-details.swig
add to: themes/hexo-theme-next/layout/_scripts/pages/post-details.swig
#}
<script type="text/javascript" src="{{ url_for(theme.custom) }}/fold_action.js?v={{ version }}"></script>
```

并在`themes/hexo-theme-next/layout/_scripts/pages/post-details.swig`的末尾加上：

```swig
{% include '../../_custom/post-details.swig' %}
```

注意：还需修改主题下的`_config.yml`如下，即加入"custom: custom"(其实是配置了source目录下的文件夹).

```yml
# Assets
css: css
js: js
images: images
custom: custom
```

最后，修改`hexo-theme-next/source/css/_custom/custom.styl`配置风格：

```styl
//ledong代码折叠功能添加: https://www.cnblogs.com/woshimrf/p/hexo-fold-block.html
.hider_title{
    font-family: "Microsoft Yahei";
    cursor: pointer;
}
.close:before{
    content: "▼";
}
.open:before{
    content: "▲";
}
.post-body div.fold_hider { margin-left: 1.5em}
.post-body div.fold { margin-top: -15px}
```

## 使用方法

{% fold 点击显/隐内容 %}

```hexo_md
{% fold 点击显/隐内容 %}
somthing...
{% endfold %}
```

{% endfold %}

## 修复自建tag里写代码块，渲染成undefined的问题

参考该文：{% post_link hexo博客配置-自建标签Bug解决方案 %}

只需添加文件`hexo-theme-next/scripts/custom/debugCustom.js`如下

{% include_code lang:js ../themes/hexo-theme-next/scripts/custom/debugCustom.js %}

## 局限

- 不能如此嵌套使用（但可嵌套正常代码块），待改进

```hexo_md
{% fold 点击显/隐内容 %}
{% include_code [title] [lang:language] path/to/file %}
{% endfold %}
```

## 参考

[参考1：Hexo添加代码块折叠](https://www.cnblogs.com/woshimrf/p/hexo-fold-block.html)

[参考2：Hexo自建标签渲染代码段Bug解决方案](https://www.oyohyee.com/post/Note/hexo_tag/)